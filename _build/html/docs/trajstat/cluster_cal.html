
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

    <title>Cluster Calculation &#8212; MeteoInfo 3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinxdoc.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Cluster Statistics" href="cluster_stat.html" />
    <link rel="prev" title="Select Trajectory" href="sel_traj.html" /> 
  </head><body>

<div style="background-color: white; text-align: left; padding: 2px 2px 2px 2px">
<a href="../../index.html"><img src="../../_static/logo.jpg" border="0"/></a></div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cluster_stat.html" title="Cluster Statistics"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sel_traj.html" title="Select Trajectory"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../news/index.html">news</a>|&nbsp;</li>
        <li><a href="../../examples/index.html">examples</a>|&nbsp;</li>
        <li><a href="../../downloads/index.html">downloads</a>|&nbsp;</li>
        <li><a href="../index.html">docs</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >TrajStat</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="trajstatrun.html" accesskey="U">Trajectory Statistics</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Cluster Calculation</a></li> 
      </ul>
    </div>


    <div class="document">

      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="cluster-calculation">
<h1>Cluster Calculation<a class="headerlink" href="#cluster-calculation" title="Permalink to this headline">¶</a></h1>
<p>A ‘Cluster Calculation’ dialog will be opened when click ‘Cluster Analysis’ menu item. There are two clustering
options with Euclidean distance or angle distance (Sirois and Bottenheim, 1995). If users only concern the directions
of the trajectories in clustering, then angle distance should be selected.</p>
<p>The Euclidean distance between two backward trajectories was then given by</p>
<img alt="../../_images/formula_1.gif" src="../../_images/formula_1.gif" />
<p>Where X1(Y1) and X2(Y2) reference to backward trajectories 1 and 2, respectively.</p>
<p>The angle distance between two backward trajectories was defined as</p>
<img alt="../../_images/formula_2.gif" src="../../_images/formula_2.gif" />
<p>where</p>
<img alt="../../_images/formula_3.gif" src="../../_images/formula_3.gif" />
<img alt="../../_images/formula_4.gif" src="../../_images/formula_4.gif" />
<img alt="../../_images/formula_5.gif" src="../../_images/formula_5.gif" />
<p>The variables X0 and Y0 define the position of the studied site. Note that d12 varies between 0 and π. The two extreme
values occur when two trajectories are in the same and opposite direction, respectively. As defined by equations (2) to
(5), d12 is the mean angle between the two backward trajectories, as seen from the studied site.</p>
<p>All trajectories must have same number of end points for cluster calculation, so <code class="docutils literal notranslate"><span class="pre">Check</span> <span class="pre">point</span> <span class="pre">number</span></code>
button should be pressed firstly, and make sure the result of <code class="docutils literal notranslate"><span class="pre">All</span> <span class="pre">trajectories</span> <span class="pre">have</span> <span class="pre">same</span> <span class="pre">point</span> <span class="pre">number...</span></code>.
Otherwise, some trajectories need to be re-calculated due to their abnormal end points numbers.
Normally, the back trajectories in the first days of a month have this problem if the meteorological
data files of last month were not included in calculation.</p>
<img alt="../../_images/cluster_cal.png" src="../../_images/cluster_cal.png" />
<p>Press ‘Calculate Cluster’ button to run the clustering program. Then a .txt file with trajectory number and cluster
members was created. In this case, maximum cluster number is set to 30 which could be changed if necessary.</p>
<img alt="../../_images/cluster_result.png" src="../../_images/cluster_result.png" />
<p>Total spatial variation (TSV) can be calculated and plotted by clicking <strong>View TSV</strong> button. The TSV percent change
vs cluster numbers figure can indicate the suitable cluster number before dramatic increasing of TSV percent. Five
cluster was determined by following figure.</p>
<img alt="../../_images/cluster_tvs.png" src="../../_images/cluster_tvs.png" />
<p>‘Eye ball’ method can also be used to determine the cluster number in this software. In ‘Cluster Calculation’ dialog, mean
trajectories and trajectory number of each cluster could be calculated and to be transferred to ESRI shape file
according to selected cluster number by pressing ‘ Mean Traj’ button. Several kinds of mean trajectories were calculated
and showed in map view, and then a suitable cluster number could be determined by your eyes. In this example, Cluster
number 5 is decided.</p>
<img alt="../../_images/cluster_angle5.png" src="../../_images/cluster_angle5.png" />
<p>Set cluster number to 5 in ‘Cluster Calculation’ dialog, and then press ‘Add to Traj’ button. Select layers in opened
‘Select Trajectory Layers’ dialog. The cluster attribute will be added to the trajectory layers with ‘Cluster’ field.</p>
<img alt="../../_images/cluster_table.png" src="../../_images/cluster_table.png" />
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    <a target="_blank" href="https://github.com/meteoinfo/MeteoInfo">
        <img style="position: fixed; top: 0; right: 0; border: 0;" 
        src="../../_static/forkme_right_orange_ff7600.png" 
        alt="Fork me on GitHub">
    </a>
    <a target="_blank" href="https://gitter.im/meteoinfo/community">
        <img style="position: fixed; bottom: 0; right: 0; border: 0;" 
        src="https://badges.gitter.im/meteoinfo/community/meteoinfo.svg" 
        alt="Join the chat at Gitter">
    </a>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="sel_traj.html"
                        title="previous chapter">Select Trajectory</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="cluster_stat.html"
                        title="next chapter">Cluster Statistics</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/docs/trajstat/cluster_cal.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cluster_stat.html" title="Cluster Statistics"
             >next</a> |</li>
        <li class="right" >
          <a href="sel_traj.html" title="Select Trajectory"
             >previous</a> |</li>
        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../news/index.html">news</a>|&nbsp;</li>
        <li><a href="../../examples/index.html">examples</a>|&nbsp;</li>
        <li><a href="../../downloads/index.html">downloads</a>|&nbsp;</li>
        <li><a href="../index.html">docs</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >TrajStat</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="trajstatrun.html" >Trajectory Statistics</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Cluster Calculation</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2021, MeteoInfo developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
  </body>
</html>